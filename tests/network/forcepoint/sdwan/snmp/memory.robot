*** Settings ***
Documentation       Forcepoint SD-WAN Mode Memory

Resource            ${CURDIR}${/}../..${/}..${/}..${/}resources/import.resource

Suite Setup         Ctn Generic Suite Setup
Test Timeout        120s


*** Variables ***
${CMD}                                          ${CENTREON_PLUGINS} --plugin=network::forcepoint::sdwan::snmp::plugin


*** Test Cases ***
memory ${tc}
    [Tags]    network    forcepoint    sdwan     snmp
    ${command}    Catenate
    ...    ${CMD}
    ...    --mode=memory
    ...    --hostname=${HOSTNAME}
    ...    --snmp-version=${SNMPVERSION}
    ...    --snmp-port=40000
    ...    --snmp-community=network/forcepoint/sdwan/snmp/forcepoint-memory
    ...    --snmp-version=${snmpver}
    ...    ${extra_options}
 
    Ctn Run Command And Check Result As Strings    ${command}    ${expected_result}

    Examples:        tc    snmpver  extra_options                   expected_result    --
            ...      1     1        --verbose                       OK: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%), Buffer: 95.33 MB, Cached: 1.07 GB, Shared: 790.87 MB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      2     1        --warning-usage='1'             WARNING: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%) | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;0:1;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      3     1        --warning-usage-free='1'        WARNING: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%) | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;0:1;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      4     1        --warning-usage-prct='1'        WARNING: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%) | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;0:1;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      5     1        --warning-swap='1'              OK: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%), Buffer: 95.33 MB, Cached: 1.07 GB, Shared: 790.87 MB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      6     1        --warning-swap-free='1'         OK: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%), Buffer: 95.33 MB, Cached: 1.07 GB, Shared: 790.87 MB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      7     1        --warning-swap-prct='0'         OK: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%), Buffer: 95.33 MB, Cached: 1.07 GB, Shared: 790.87 MB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      8     1        --warning-buffer='40'           WARNING: Buffer: 95.33 MB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;0:40;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      9     1        --warning-cached='1'            WARNING: Cached: 1.07 GB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;0:1;;0; 'shared'=829284352B;;;0;
            ...      10    1        --warning-shared='1'            WARNING: Shared: 790.87 MB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;0:1;;0;
            ...      11    1        --patch-redhat='1'              OK: Ram Total: 3.72 GB Used (-buffers/cache): 3.37 GB (90.74%) Free: 352.19 MB (9.26%), Buffer: 95.33 MB, Cached: 1.07 GB, Shared: 790.87 MB | 'used'=3619979264B;;;0;3989274624 'free'=369295360B;;;0;3989274624 'used_prct'=90.74%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      12    1        --critical-usage='1'            CRITICAL: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%) | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;0:1;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      13    1        --critical-usage-free='1'       CRITICAL: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%) | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;0:1;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      14    1        --critical-usage-prct='1'       CRITICAL: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%) | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;0:1;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      15    1        --critical-swap='1'             OK: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%), Buffer: 95.33 MB, Cached: 1.07 GB, Shared: 790.87 MB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      16    1        --critical-swap-free='1'        OK: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%), Buffer: 95.33 MB, Cached: 1.07 GB, Shared: 790.87 MB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      17    1        --critical-swap-prct='1'        OK: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%), Buffer: 95.33 MB, Cached: 1.07 GB, Shared: 790.87 MB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      18    1        --critical-buffer='1'           CRITICAL: Buffer: 95.33 MB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;0:1;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      19    1        --critical-cached='1'           CRITICAL: Cached: 1.07 GB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;0:1;0; 'shared'=829284352B;;;0;
            ...      20    1        --critical-shared='1'           CRITICAL: Shared: 790.87 MB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;0:1;0;
            ...      21    1        --patch-redhat='1'              OK: Ram Total: 3.72 GB Used (-buffers/cache): 3.37 GB (90.74%) Free: 352.19 MB (9.26%), Buffer: 95.33 MB, Cached: 1.07 GB, Shared: 790.87 MB | 'used'=3619979264B;;;0;3989274624 'free'=369295360B;;;0;3989274624 'used_prct'=90.74%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      22    2c       --warning-usage='1'             WARNING: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%) | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;0:1;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      23    2c       --warning-usage-free='1'        WARNING: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%) | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;0:1;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      24    2c       --warning-usage-prct='1'        WARNING: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%) | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;0:1;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      25    2c       --warning-swap='1'              OK: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%), Buffer: 95.33 MB, Cached: 1.07 GB, Shared: 790.87 MB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      26    2c       --warning-swap-free='1'         OK: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%), Buffer: 95.33 MB, Cached: 1.07 GB, Shared: 790.87 MB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      27    2c       --warning-swap-prct='0'         OK: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%), Buffer: 95.33 MB, Cached: 1.07 GB, Shared: 790.87 MB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      28    2c       --warning-buffer='40'           WARNING: Buffer: 95.33 MB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;0:40;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      29    2c       --warning-cached='1'            WARNING: Cached: 1.07 GB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;0:1;;0; 'shared'=829284352B;;;0;
            ...      30    2c       --warning-shared='1'            WARNING: Shared: 790.87 MB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;0:1;;0;
            ...      31    2c       --patch-redhat='1'              OK: Ram Total: 3.72 GB Used (-buffers/cache): 3.37 GB (90.74%) Free: 352.19 MB (9.26%), Buffer: 95.33 MB, Cached: 1.07 GB, Shared: 790.87 MB | 'used'=3619979264B;;;0;3989274624 'free'=369295360B;;;0;3989274624 'used_prct'=90.74%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      32    2c       --critical-usage='1'            CRITICAL: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%) | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;0:1;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      33    2c       --critical-usage-free='1'       CRITICAL: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%) | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;0:1;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      34    2c       --critical-usage-prct='1'       CRITICAL: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%) | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;0:1;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      35    2c       --critical-swap='1'             OK: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%), Buffer: 95.33 MB, Cached: 1.07 GB, Shared: 790.87 MB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      36    2c       --critical-swap-free='1'        OK: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%), Buffer: 95.33 MB, Cached: 1.07 GB, Shared: 790.87 MB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      37    2c       --critical-swap-prct='1'        OK: Ram Total: 3.72 GB Used (-buffers/cache): 2.20 GB (59.31%) Free: 1.51 GB (40.69%), Buffer: 95.33 MB, Cached: 1.07 GB, Shared: 790.87 MB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      38    2c       --critical-buffer='1'           CRITICAL: Buffer: 95.33 MB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;0:1;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;
            ...      39    2c       --critical-cached='1'           CRITICAL: Cached: 1.07 GB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;0:1;0; 'shared'=829284352B;;;0;
            ...      40    2c       --critical-shared='1'           CRITICAL: Shared: 790.87 MB | 'used'=2366033920B;;;0;3989274624 'free'=1623240704B;;;0;3989274624 'used_prct'=59.31%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;0:1;0;
            ...      41    2c       --patch-redhat='1'              OK: Ram Total: 3.72 GB Used (-buffers/cache): 3.37 GB (90.74%) Free: 352.19 MB (9.26%), Buffer: 95.33 MB, Cached: 1.07 GB, Shared: 790.87 MB | 'used'=3619979264B;;;0;3989274624 'free'=369295360B;;;0;3989274624 'used_prct'=90.74%;;;0;100 'buffer'=99962880B;;;0; 'cached'=1153982464B;;;0; 'shared'=829284352B;;;0;

