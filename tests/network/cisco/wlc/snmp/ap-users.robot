*** Settings ***
Documentation       Check users connected (total, by SSID, by AP).

Resource            ${CURDIR}${/}..${/}..${/}..${/}..${/}resources/import.resource

Test Timeout        120s


*** Variables ***
${CMD}      ${CENTREON_PLUGINS} --plugin=network::cisco::wlc::snmp::plugin


*** Test Cases ***
ap-users ${tc}
    [Tags]    network    wlc    snmp
    ${command}    Catenate
    ...    ${CMD}
    ...    --mode=ap-users
    ...    --hostname=${HOSTNAME}
    ...    --snmp-port=${SNMPPORT}
    ...    --snmp-community=network/cisco/wlc/snmp/slim_cisco_wlc
    ...    ${extra_options}

    Ctn Run Command And Check Result As Strings    ${command}    ${expected_result}

    Examples:        tc    extra_options                                                  expected_result    --
            ...      1     --filter-counters                                              OK: Users total: 17, idle: 0, aaaPending: 0, authenticated: 0, associated: 17, disassociated: 0, powersave: 0, to be deleted: 0, probing: 0, blacklisted: 0 - All users by SSID are ok - All users by access point are ok | 'total'=17users;;;0; 'total_idle'=0users;;;0; 'total_aaapending'=0users;;;0; 'total_authenticated'=0users;;;0; 'total_associated'=17users;;;0; 'total_disassociated'=0users;;;0; 'total_powersave'=0users;;;0; 'total_tobedeleted'=0users;;;0; 'total_probing'=0users;;;0; 'total_blacklisted'=0users;;;0; 'ssid_Anonymized 001'=1users;;;0; 'ssid_Anonymized 031'=1users;;;0; 'ssid_Anonymized 034'=1users;;;0; 'ssid_Anonymized 036'=1users;;;0; 'ssid_Anonymized 059'=1users;;;0; 'ssid_Anonymized 071'=1users;;;0; 'ssid_Anonymized 100'=1users;;;0; 'ssid_Anonymized 118'=2users;;;0; 'ssid_Anonymized 124'=0users;;;0; 'ssid_Anonymized 171'=1users;;;0; 'ssid_Anonymized 175'=0users;;;0; 'ssid_Anonymized 180'=1users;;;0; 'ssid_Anonymized 182'=1users;;;0; 'ssid_Anonymized 183'=1users;;;0; 'ssid_Anonymized 187'=0users;;;0; 'ssid_Anonymized 209'=1users;;;0; 'ssid_Anonymized 226'=1users;;;0; 'ssid_Anonymized 239'=1users;;;0; 'ssid_Anonymized 253'=0users;;;0; 'ssid_Anonymized 254'=1users;;;0; 'ap_Anonymized 015'=0users;;;0; 'ap_Anonymized 201'=2users;;;0; 'ap_Anonymized 181'=4users;;;0; 'ap_Anonymized 035'=2users;;;0; 'ap_Anonymized 089'=3users;;;0; 'ap_Anonymized 072'=1users;;;0; 'ap_Anonymized 122'=1users;;;0; 'ap_Anonymized 007'=2users;;;0; 'ap_Anonymized 249'=3users;;;0; 'ap_Anonymized 108'=2users;;;0;
            ...      2     --filter-ssid='toto'                                           OK: Users total: 0, idle: 0, aaaPending: 0, authenticated: 0, associated: 0, disassociated: 0, powersave: 0, to be deleted: 0, probing: 0, blacklisted: 0 - All users by access point are ok | 'total'=0users;;;0; 'total_idle'=0users;;;0; 'total_aaapending'=0users;;;0; 'total_authenticated'=0users;;;0; 'total_associated'=0users;;;0; 'total_disassociated'=0users;;;0; 'total_powersave'=0users;;;0; 'total_tobedeleted'=0users;;;0; 'total_probing'=0users;;;0; 'total_blacklisted'=0users;;;0; 'ap_Anonymized 015'=0users;;;0; 'ap_Anonymized 201'=2users;;;0; 'ap_Anonymized 181'=4users;;;0; 'ap_Anonymized 035'=2users;;;0; 'ap_Anonymized 089'=3users;;;0; 'ap_Anonymized 072'=1users;;;0; 'ap_Anonymized 122'=1users;;;0; 'ap_Anonymized 007'=2users;;;0; 'ap_Anonymized 249'=3users;;;0; 'ap_Anonymized 108'=2users;;;0;
            ...      3     --filter-ap                                                    OK: Users total: 17, idle: 0, aaaPending: 0, authenticated: 0, associated: 17, disassociated: 0, powersave: 0, to be deleted: 0, probing: 0, blacklisted: 0 - All users by SSID are ok - All users by access point are ok | 'total'=17users;;;0; 'total_idle'=0users;;;0; 'total_aaapending'=0users;;;0; 'total_authenticated'=0users;;;0; 'total_associated'=17users;;;0; 'total_disassociated'=0users;;;0; 'total_powersave'=0users;;;0; 'total_tobedeleted'=0users;;;0; 'total_probing'=0users;;;0; 'total_blacklisted'=0users;;;0; 'ssid_Anonymized 001'=1users;;;0; 'ssid_Anonymized 031'=1users;;;0; 'ssid_Anonymized 034'=1users;;;0; 'ssid_Anonymized 036'=1users;;;0; 'ssid_Anonymized 059'=1users;;;0; 'ssid_Anonymized 071'=1users;;;0; 'ssid_Anonymized 100'=1users;;;0; 'ssid_Anonymized 118'=2users;;;0; 'ssid_Anonymized 124'=0users;;;0; 'ssid_Anonymized 171'=1users;;;0; 'ssid_Anonymized 175'=0users;;;0; 'ssid_Anonymized 180'=1users;;;0; 'ssid_Anonymized 182'=1users;;;0; 'ssid_Anonymized 183'=1users;;;0; 'ssid_Anonymized 187'=0users;;;0; 'ssid_Anonymized 209'=1users;;;0; 'ssid_Anonymized 226'=1users;;;0; 'ssid_Anonymized 239'=1users;;;0; 'ssid_Anonymized 253'=0users;;;0; 'ssid_Anonymized 254'=1users;;;0; 'ap_Anonymized 015'=0users;;;0; 'ap_Anonymized 201'=2users;;;0; 'ap_Anonymized 181'=4users;;;0; 'ap_Anonymized 035'=2users;;;0; 'ap_Anonymized 089'=3users;;;0; 'ap_Anonymized 072'=1users;;;0; 'ap_Anonymized 122'=1users;;;0; 'ap_Anonymized 007'=2users;;;0; 'ap_Anonymized 249'=3users;;;0; 'ap_Anonymized 108'=2users;;;0;
            ...      4     --filter-group=''                                              OK: Users total: 17, idle: 0, aaaPending: 0, authenticated: 0, associated: 17, disassociated: 0, powersave: 0, to be deleted: 0, probing: 0, blacklisted: 0 - All users by SSID are ok - All users by access point are ok | 'total'=17users;;;0; 'total_idle'=0users;;;0; 'total_aaapending'=0users;;;0; 'total_authenticated'=0users;;;0; 'total_associated'=17users;;;0; 'total_disassociated'=0users;;;0; 'total_powersave'=0users;;;0; 'total_tobedeleted'=0users;;;0; 'total_probing'=0users;;;0; 'total_blacklisted'=0users;;;0; 'ssid_Anonymized 001'=1users;;;0; 'ssid_Anonymized 031'=1users;;;0; 'ssid_Anonymized 034'=1users;;;0; 'ssid_Anonymized 036'=1users;;;0; 'ssid_Anonymized 059'=1users;;;0; 'ssid_Anonymized 071'=1users;;;0; 'ssid_Anonymized 100'=1users;;;0; 'ssid_Anonymized 118'=2users;;;0; 'ssid_Anonymized 124'=0users;;;0; 'ssid_Anonymized 171'=1users;;;0; 'ssid_Anonymized 175'=0users;;;0; 'ssid_Anonymized 180'=1users;;;0; 'ssid_Anonymized 182'=1users;;;0; 'ssid_Anonymized 183'=1users;;;0; 'ssid_Anonymized 187'=0users;;;0; 'ssid_Anonymized 209'=1users;;;0; 'ssid_Anonymized 226'=1users;;;0; 'ssid_Anonymized 239'=1users;;;0; 'ssid_Anonymized 253'=0users;;;0; 'ssid_Anonymized 254'=1users;;;0; 'ap_Anonymized 015'=0users;;;0; 'ap_Anonymized 201'=2users;;;0; 'ap_Anonymized 181'=4users;;;0; 'ap_Anonymized 035'=2users;;;0; 'ap_Anonymized 089'=3users;;;0; 'ap_Anonymized 072'=1users;;;0; 'ap_Anonymized 122'=1users;;;0; 'ap_Anonymized 007'=2users;;;0; 'ap_Anonymized 249'=3users;;;0; 'ap_Anonymized 108'=2users;;;0;
            ...      5     --ignore-ap-users                                              OK: Users total: 17, idle: 0, aaaPending: 0, authenticated: 0, associated: 17, disassociated: 0, powersave: 0, to be deleted: 0, probing: 0, blacklisted: 0 - All users by SSID are ok | 'total'=17users;;;0; 'total_idle'=0users;;;0; 'total_aaapending'=0users;;;0; 'total_authenticated'=0users;;;0; 'total_associated'=17users;;;0; 'total_disassociated'=0users;;;0; 'total_powersave'=0users;;;0; 'total_tobedeleted'=0users;;;0; 'total_probing'=0users;;;0; 'total_blacklisted'=0users;;;0; 'ssid_Anonymized 001'=1users;;;0; 'ssid_Anonymized 031'=1users;;;0; 'ssid_Anonymized 034'=1users;;;0; 'ssid_Anonymized 036'=1users;;;0; 'ssid_Anonymized 059'=1users;;;0; 'ssid_Anonymized 071'=1users;;;0; 'ssid_Anonymized 100'=1users;;;0; 'ssid_Anonymized 118'=2users;;;0; 'ssid_Anonymized 124'=0users;;;0; 'ssid_Anonymized 171'=1users;;;0; 'ssid_Anonymized 175'=0users;;;0; 'ssid_Anonymized 180'=1users;;;0; 'ssid_Anonymized 182'=1users;;;0; 'ssid_Anonymized 183'=1users;;;0; 'ssid_Anonymized 187'=0users;;;0; 'ssid_Anonymized 209'=1users;;;0; 'ssid_Anonymized 226'=1users;;;0; 'ssid_Anonymized 239'=1users;;;0; 'ssid_Anonymized 253'=0users;;;0; 'ssid_Anonymized 254'=1users;;;0;
            ...      6     --warning-total=0 --critical-total=100                         WARNING: Users total: 17 | 'total'=17users;0:0;0:100;0; 'total_idle'=0users;;;0; 'total_aaapending'=0users;;;0; 'total_authenticated'=0users;;;0; 'total_associated'=17users;;;0; 'total_disassociated'=0users;;;0; 'total_powersave'=0users;;;0; 'total_tobedeleted'=0users;;;0; 'total_probing'=0users;;;0; 'total_blacklisted'=0users;;;0; 'ssid_Anonymized 001'=1users;;;0; 'ssid_Anonymized 031'=1users;;;0; 'ssid_Anonymized 034'=1users;;;0; 'ssid_Anonymized 036'=1users;;;0; 'ssid_Anonymized 059'=1users;;;0; 'ssid_Anonymized 071'=1users;;;0; 'ssid_Anonymized 100'=1users;;;0; 'ssid_Anonymized 118'=2users;;;0; 'ssid_Anonymized 124'=0users;;;0; 'ssid_Anonymized 171'=1users;;;0; 'ssid_Anonymized 175'=0users;;;0; 'ssid_Anonymized 180'=1users;;;0; 'ssid_Anonymized 182'=1users;;;0; 'ssid_Anonymized 183'=1users;;;0; 'ssid_Anonymized 187'=0users;;;0; 'ssid_Anonymized 209'=1users;;;0; 'ssid_Anonymized 226'=1users;;;0; 'ssid_Anonymized 239'=1users;;;0; 'ssid_Anonymized 253'=0users;;;0; 'ssid_Anonymized 254'=1users;;;0; 'ap_Anonymized 015'=0users;;;0; 'ap_Anonymized 201'=2users;;;0; 'ap_Anonymized 181'=4users;;;0; 'ap_Anonymized 035'=2users;;;0; 'ap_Anonymized 089'=3users;;;0; 'ap_Anonymized 072'=1users;;;0; 'ap_Anonymized 122'=1users;;;0; 'ap_Anonymized 007'=2users;;;0; 'ap_Anonymized 249'=3users;;;0; 'ap_Anonymized 108'=2users;;;0;
            ...      7     --warning-total=100 --critical-total=0                         CRITICAL: Users total: 17 | 'total'=17users;0:100;0:0;0; 'total_idle'=0users;;;0; 'total_aaapending'=0users;;;0; 'total_authenticated'=0users;;;0; 'total_associated'=17users;;;0; 'total_disassociated'=0users;;;0; 'total_powersave'=0users;;;0; 'total_tobedeleted'=0users;;;0; 'total_probing'=0users;;;0; 'total_blacklisted'=0users;;;0; 'ssid_Anonymized 001'=1users;;;0; 'ssid_Anonymized 031'=1users;;;0; 'ssid_Anonymized 034'=1users;;;0; 'ssid_Anonymized 036'=1users;;;0; 'ssid_Anonymized 059'=1users;;;0; 'ssid_Anonymized 071'=1users;;;0; 'ssid_Anonymized 100'=1users;;;0; 'ssid_Anonymized 118'=2users;;;0; 'ssid_Anonymized 124'=0users;;;0; 'ssid_Anonymized 171'=1users;;;0; 'ssid_Anonymized 175'=0users;;;0; 'ssid_Anonymized 180'=1users;;;0; 'ssid_Anonymized 182'=1users;;;0; 'ssid_Anonymized 183'=1users;;;0; 'ssid_Anonymized 187'=0users;;;0; 'ssid_Anonymized 209'=1users;;;0; 'ssid_Anonymized 226'=1users;;;0; 'ssid_Anonymized 239'=1users;;;0; 'ssid_Anonymized 253'=0users;;;0; 'ssid_Anonymized 254'=1users;;;0; 'ap_Anonymized 015'=0users;;;0; 'ap_Anonymized 201'=2users;;;0; 'ap_Anonymized 181'=4users;;;0; 'ap_Anonymized 035'=2users;;;0; 'ap_Anonymized 089'=3users;;;0; 'ap_Anonymized 072'=1users;;;0; 'ap_Anonymized 122'=1users;;;0; 'ap_Anonymized 007'=2users;;;0; 'ap_Anonymized 249'=3users;;;0; 'ap_Anonymized 108'=2users;;;0;
            ...      8     --warning-ssid=0 --critical-ssid=100                           WARNING: SSID 'Anonymized 001' users: 1 - SSID 'Anonymized 031' users: 1 - SSID 'Anonymized 034' users: 1 - SSID 'Anonymized 036' users: 1 - SSID 'Anonymized 059' users: 1 - SSID 'Anonymized 071' users: 1 - SSID 'Anonymized 100' users: 1 - SSID 'Anonymized 118' users: 2 - SSID 'Anonymized 171' users: 1 - SSID 'Anonymized 180' users: 1 - SSID 'Anonymized 182' users: 1 - SSID 'Anonymized 183' users: 1 - SSID 'Anonymized 209' users: 1 - SSID 'Anonymized 226' users: 1 - SSID 'Anonymized 239' users: 1 - SSID 'Anonymized 254' users: 1 | 'total'=17users;;;0; 'total_idle'=0users;;;0; 'total_aaapending'=0users;;;0; 'total_authenticated'=0users;;;0; 'total_associated'=17users;;;0; 'total_disassociated'=0users;;;0; 'total_powersave'=0users;;;0; 'total_tobedeleted'=0users;;;0; 'total_probing'=0users;;;0; 'total_blacklisted'=0users;;;0; 'ssid_Anonymized 001'=1users;0:0;0:100;0; 'ssid_Anonymized 031'=1users;0:0;0:100;0; 'ssid_Anonymized 034'=1users;0:0;0:100;0; 'ssid_Anonymized 036'=1users;0:0;0:100;0; 'ssid_Anonymized 059'=1users;0:0;0:100;0; 'ssid_Anonymized 071'=1users;0:0;0:100;0; 'ssid_Anonymized 100'=1users;0:0;0:100;0; 'ssid_Anonymized 118'=2users;0:0;0:100;0; 'ssid_Anonymized 124'=0users;0:0;0:100;0; 'ssid_Anonymized 171'=1users;0:0;0:100;0; 'ssid_Anonymized 175'=0users;0:0;0:100;0; 'ssid_Anonymized 180'=1users;0:0;0:100;0; 'ssid_Anonymized 182'=1users;0:0;0:100;0; 'ssid_Anonymized 183'=1users;0:0;0:100;0; 'ssid_Anonymized 187'=0users;0:0;0:100;0; 'ssid_Anonymized 209'=1users;0:0;0:100;0; 'ssid_Anonymized 226'=1users;0:0;0:100;0; 'ssid_Anonymized 239'=1users;0:0;0:100;0; 'ssid_Anonymized 253'=0users;0:0;0:100;0; 'ssid_Anonymized 254'=1users;0:0;0:100;0; 'ap_Anonymized 015'=0users;;;0; 'ap_Anonymized 201'=2users;;;0; 'ap_Anonymized 181'=4users;;;0; 'ap_Anonymized 035'=2users;;;0; 'ap_Anonymized 089'=3users;;;0; 'ap_Anonymized 072'=1users;;;0; 'ap_Anonymized 122'=1users;;;0; 'ap_Anonymized 007'=2users;;;0; 'ap_Anonymized 249'=3users;;;0; 'ap_Anonymized 108'=2users;;;0;
            ...      9     --verbose                                                      OK: Users total: 17, idle: 0, aaaPending: 0, authenticated: 0, associated: 17, disassociated: 0, powersave: 0, to be deleted: 0, probing: 0, blacklisted: 0 - All users by SSID are ok - All users by access point are ok | 'total'=17users;;;0; 'total_idle'=0users;;;0; 'total_aaapending'=0users;;;0; 'total_authenticated'=0users;;;0; 'total_associated'=17users;;;0; 'total_disassociated'=0users;;;0; 'total_powersave'=0users;;;0; 'total_tobedeleted'=0users;;;0; 'total_probing'=0users;;;0; 'total_blacklisted'=0users;;;0; 'ssid_Anonymized 001'=1users;;;0; 'ssid_Anonymized 031'=1users;;;0; 'ssid_Anonymized 034'=1users;;;0; 'ssid_Anonymized 036'=1users;;;0; 'ssid_Anonymized 059'=1users;;;0; 'ssid_Anonymized 071'=1users;;;0; 'ssid_Anonymized 100'=1users;;;0; 'ssid_Anonymized 118'=2users;;;0; 'ssid_Anonymized 124'=0users;;;0; 'ssid_Anonymized 171'=1users;;;0; 'ssid_Anonymized 175'=0users;;;0; 'ssid_Anonymized 180'=1users;;;0; 'ssid_Anonymized 182'=1users;;;0; 'ssid_Anonymized 183'=1users;;;0; 'ssid_Anonymized 187'=0users;;;0; 'ssid_Anonymized 209'=1users;;;0; 'ssid_Anonymized 226'=1users;;;0; 'ssid_Anonymized 239'=1users;;;0; 'ssid_Anonymized 253'=0users;;;0; 'ssid_Anonymized 254'=1users;;;0; 'ap_Anonymized 015'=0users;;;0; 'ap_Anonymized 201'=2users;;;0; 'ap_Anonymized 181'=4users;;;0; 'ap_Anonymized 035'=2users;;;0; 'ap_Anonymized 089'=3users;;;0; 'ap_Anonymized 072'=1users;;;0; 'ap_Anonymized 122'=1users;;;0; 'ap_Anonymized 007'=2users;;;0; 'ap_Anonymized 249'=3users;;;0; 'ap_Anonymized 108'=2users;;;0; Model: unknown SSID 'Anonymized 001' users: 1 SSID 'Anonymized 031' users: 1 SSID 'Anonymized 034' users: 1 SSID 'Anonymized 036' users: 1 SSID 'Anonymized 059' users: 1 SSID 'Anonymized 071' users: 1 SSID 'Anonymized 100' users: 1 SSID 'Anonymized 118' users: 2 SSID 'Anonymized 124' users: 0 SSID 'Anonymized 171' users: 1 SSID 'Anonymized 175' users: 0 SSID 'Anonymized 180' users: 1 SSID 'Anonymized 182' users: 1 SSID 'Anonymized 183' users: 1 SSID 'Anonymized 187' users: 0 SSID 'Anonymized 209' users: 1 SSID 'Anonymized 226' users: 1 SSID 'Anonymized 239' users: 1 SSID 'Anonymized 253' users: 0 SSID 'Anonymized 254' users: 1 Access point 'Anonymized 015' users: 0 Access point 'Anonymized 201' users: 2 Access point 'Anonymized 181' users: 4 Access point 'Anonymized 035' users: 2 Access point 'Anonymized 089' users: 3 Access point 'Anonymized 072' users: 1 Access point 'Anonymized 122' users: 1 Access point 'Anonymized 007' users: 2 Access point 'Anonymized 249' users: 3 Access point 'Anonymized 108' users: 2