{
  "snmp": {
    "tables": [
      {
        "name": "memory",
        "oid": ".1.3.6.1.2.1.25.2.3.1",
        "used_instance": ".*\\.(\\d+)$",
        "entries": [
          {
            "name": "descr",
            "oid": ".1.3.6.1.2.1.25.2.3.1.3"
          },
          {
            "name": "size",
            "oid": ".1.3.6.1.2.1.25.2.3.1.5"
          },
          {
            "name": "used",
            "oid": ".1.3.6.1.2.1.25.2.3.1.6"
          }
        ]
      }
    ]
  },
  "selection_loop": [
    {
      "name": "memory",
      "source": "%(snmp.tables.memory)",
      "warning": "%(constants.warning) ne '' && %(memory.used) * 100 / %(memory.size) > %(constants.warning)",
      "critical": "%(constants.critical) ne '' && %(memory.used) * 100 / %(memory.size) > %(constants.critical)",
      "perfdatas": [
        {
          "nlabel": "memory.usage.bytes",
          "instances": ["%(memory.instance)"],
          "value": "%(memory.used)"
        },
        {
          "nlabel": "memory.size.bytes",
          "instances": ["%(memory.instance)"],
          "value": "%(memory.size)"
        }
      ],
      "formatting": {
        "printf_msg": "Memory '%s' usage : %s / %s",
        "printf_var": [
          "%(memory.descr)",
          "%(memory.used)",
          "%(memory.size)"
        ],
        "display_ok": true
      }
    }
  ]
}