.. _messageQueueSizeFiltered:

*************************************************************************
Nombre de message dans une message queue (MSGQ) filtré par ID et severité
*************************************************************************

Description
^^^^^^^^^^^

+------------------+------------------------------------------------------------------------------------------------------+
| Description      | Controle le nombre de message dans une message queue en filtrant par ID et sevérité                  |
+------------------+------------------------------------------------------------------------------------------------------+
| Fonctionnement   | Récupère tous les message dont la sévérité est supérieur ou égale à celle défini dans les arguments. |
|                  | Ok si le nombre de message est en dessous du seuil warning.                                          |
|                  | Warning si le nombre de message est au dessus du seuil warning.                                      |
|                  | Critical si le nombre de message est au dessus du seuil critical.                                    |
+------------------+------------------------------------------------------------------------------------------------------+
| API utilisée     | QGYOLMSG format LSTM0100, QGYGTLE, QGYCLST                                                           |
+------------------+------------------------------------------------------------------------------------------------------+
| Autorité requise | *USE sur la messageQueue, *EXECUTE sur la messageQueue library                                       |
+------------------+------------------------------------------------------------------------------------------------------+

Arguments de la commande
^^^^^^^^^^^^^^^^^^^^^^^^

+--------------------------+--------------------+---------------------+----------------------------------------------------------+------------------------+
| Nom de la commande       | Nombre d'arguments | Arguments           |                                                          |                        |
+--------------------------+--------------------+---------------------+----------------------------------------------------------+------------------------+
| messageQueueSizeFiltered | 6                  | Ordre des arguments | Description                                              | Exemple                |
+--------------------------+--------------------+---------------------+----------------------------------------------------------+------------------------+
|                          |                    | Argument 1          | Nom de la messageQueue                                   | /QSYS.LIB/QSYSOPR.MSGQ |
+--------------------------+--------------------+---------------------+----------------------------------------------------------+------------------------+
|                          |                    | Argument 2          | Regex filtrant sur l'ID du message                       | ^CP.*$                 |
+--------------------------+--------------------+---------------------+----------------------------------------------------------+------------------------+
|                          |                    | Argument 3          | Niveau de sévérité minimum pour comptabiliser le message | 60                     |
+--------------------------+--------------------+---------------------+----------------------------------------------------------+------------------------+
|                          |                    | Argument 4          | Niveau de sévérité maximum pour comptabiliser le message | 80                     |
|                          |                    |                     | Sévérité maximum exclue                                  |                        |
+--------------------------+--------------------+---------------------+----------------------------------------------------------+------------------------+
|                          |                    | Argument 5          | Seuil warning (quantité)                                 | 1                      |
+--------------------------+--------------------+---------------------+----------------------------------------------------------+------------------------+
|                          |                    | Argument 6          | Seuil critique (quantité)                                | 2                      |
+--------------------------+--------------------+---------------------+----------------------------------------------------------+------------------------+
| Métriques renvoyées      | count=1234         |                     |                                                          |                        |
+--------------------------+--------------------+---------------------+----------------------------------------------------------+------------------------+

Consommation réseau
^^^^^^^^^^^^^^^^^^^

+-------------------------------------------------+---------------------------------+-------------------------------+
| Nombre de message présent dans la message queue | Download (as400 vers connector) | Upload (connector vers as400) |
+-------------------------------------------------+---------------------------------+-------------------------------+
| 1 (théorique)                                   | 2,26 ko                         | 66 o                          |
+-------------------------------------------------+---------------------------------+-------------------------------+
| 5000                                            | 11 mo                           | 325 ko                        |
+-------------------------------------------------+---------------------------------+-------------------------------+

Exemple de configuration
^^^^^^^^^^^^^^^^^^^^^^^^

+-----------------+-----------------------------------------+
| Nom de la macro | Valeur de la macro                      |
+-----------------+-----------------------------------------+
| CHECK           | messageQueueSize                        |
+-----------------+-----------------------------------------+
| ARGS            | /QSYS.LIB/QSYSOPR.MSGQ!^CP.*$!60!80!1!2 |
+-----------------+-----------------------------------------+
