<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tableau de Bord - Suivi Projet Proximus</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8fafc;
            color: #374151;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .header h1 {
            color: #1f2937;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .metric-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            text-align: center;
            border-left: 4px solid #3b82f6;
        }
        
        .metric-card h3 {
            font-size: 0.9rem;
            color: #6b7280;
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .metric-card .value {
            font-size: 2rem;
            font-weight: bold;
            color: #1d4ed8;
        }
        
        .chart-container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }
        
        .chart-container h2 {
            margin-bottom: 20px;
            color: #1f2937;
            font-size: 1.5rem;
        }
        
        .chart-wrapper {
            position: relative;
            height: 400px;
            margin-bottom: 20px;
        }
        
        .table-container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }
        
        th {
            background-color: #f9fafb;
            font-weight: 600;
            color: #374151;
        }
        
        tr:hover {
            background-color: #f9fafb;
        }
        
        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .status-not-started {
            background-color: #f3f4f6;
            color: #374151;
        }
        
        .status-started {
            background-color: #dbeafe;
            color: #1d4ed8;
        }
        
        .status-in-progress {
            background-color: #fef3c7;
            color: #d97706;
        }
        
        .status-completed {
            background-color: #d1fae5;
            color: #059669;
        }
        
        .notes {
            background-color: #eff6ff;
            border-left: 4px solid #3b82f6;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
        }
        
        .notes p {
            color: #1e40af;
            font-size: 0.9rem;
        }
        
        @media print {
            body {
                background: white;
            }
            .chart-wrapper {
                height: 300px;
            }
            .notes {
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Tableau de Bord - Suivi Projet Proximus</h1>
            <p>Estimation vs Réalisation - Avril 2025</p>
        </div>

        <!-- Métriques de synthèse -->
        <div class="metrics-grid">
            <div class="metric-card">
                <h3>Total Estimé</h3>
                <div class="value">425.24j</div>
            </div>
            <div class="metric-card">
                <h3>Total Réalisé</h3>
                <div class="value">43j</div>
            </div>
            <div class="metric-card">
                <h3>Total Restant</h3>
                <div class="value">382.24j</div>
            </div>
            <div class="metric-card">
                <h3>Projets Démarrés</h3>
                <div class="value">3</div>
            </div>
            <div class="metric-card">
                <h3>Total Projets</h3>
                <div class="value">17</div>
            </div>
            <div class="metric-card">
                <h3>Taux Avancement</h3>
                <div class="value">10.1%</div>
            </div>
        </div>

        <!-- Graphique principal -->
        <div class="chart-container">
            <h2>Comparaison Estimé vs Réalisé par Projet</h2>
            <div class="chart-wrapper">
                <canvas id="mainChart"></canvas>
            </div>
        </div>

        <!-- Graphique par phases -->
        <div class="chart-container">
            <h2>Consommation par Phase</h2>
            <div class="chart-wrapper">
                <canvas id="phaseChart"></canvas>
            </div>
        </div>

        <!-- Tableau détaillé -->
        <div class="table-container">
            <h2>Détail par Projet</h2>
            <table id="projectTable">
                <thead>
                    <tr>
                        <th>Projet</th>
                        <th style="text-align: right;">Estimé (j)</th>
                        <th style="text-align: right;">Réalisé (j)</th>
                        <th style="text-align: right;">Restant (j)</th>
                        <th style="text-align: right;">Avancement (%)</th>
                        <th style="text-align: center;">Statut</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Données générées par JavaScript -->
                </tbody>
            </table>
        </div>

        <!-- Notes -->
        <div class="notes">
            <p><strong>Notes:</strong> Ce tableau de bord présente la comparaison entre les estimations initiales et la consommation réelle pour le projet Proximus (Avril). La colonne "Restant" indique le nombre de jours restants à consommer pour chaque projet (Estimé - Réalisé).</p>
        </div>
    </div>

    <script>
        // Données du projet
        const projectData = [
            { name: "tango-external-keycloak-search", estimated: 22.67, actual: 14.3 },
            { name: "bad-customer-internal", estimated: 12.94, actual: 7.5 },
            { name: "ftth-db-router", estimated: 29.41, actual: 1.5 },
            { name: "payment-internal", estimated: 47.06, actual: 0 },
            { name: "esignature-router-service", estimated: 35.30, actual: 0 },
            { name: "Address-Service", estimated: 33.34, actual: 19.7 },
            { name: "esim-internal", estimated: 38.24, actual: 0 },
            { name: "hdm-device-mgmt-service", estimated: 28.73, actual: 0 },
            { name: "billing-adapter-legacy", estimated: 33.43, actual: 0 },
            { name: "billing-adapter", estimated: 13.73, actual: 0 },
            { name: "campaign-management-service", estimated: 49.02, actual: 0 },
            { name: "notification-service", estimated: 33.34, actual: 0 },
            { name: "qr-code-internal", estimated: 5.88, actual: 0 },
            { name: "sfa-es", estimated: 7.84, actual: 0 },
            { name: "smsc", estimated: 11.77, actual: 0 },
            { name: "tango-ux-event-service", estimated: 12.75, actual: 0 },
            { name: "tango-eap-common", estimated: 9.80, actual: 0 }
        ];

        const phaseData = [
            { phase: "Conception", estimated: 26.08, actual: 6 },
            { phase: "Développement", estimated: 217.3, actual: 31 },
            { phase: "Validation", estimated: 15.21, actual: 0 },
            { phase: "Revue", estimated: 10.87, actual: 0 },
            { phase: "QA", estimated: 72.79, actual: 3 },
            { phase: "R7", estimated: 21.73, actual: 0 },
            { phase: "Pilotage", estimated: 61.87, actual: 3 }
        ];

        // Configuration des graphiques
        const chartConfig = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'top',
                },
            },
            scales: {
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'Jours'
                    }
                }
            }
        };

        // Graphique principal
        const ctx1 = document.getElementById('mainChart').getContext('2d');
        new Chart(ctx1, {
            type: 'bar',
            data: {
                labels: projectData.map(p => p.name.length > 20 ? p.name.substring(0, 20) + '...' : p.name),
                datasets: [
                    {
                        label: 'Estimé',
                        data: projectData.map(p => p.estimated),
                        backgroundColor: 'rgba(136, 132, 216, 0.8)',
                        borderColor: 'rgba(136, 132, 216, 1)',
                        borderWidth: 1
                    },
                    {
                        label: 'Réalisé',
                        data: projectData.map(p => p.actual),
                        backgroundColor: 'rgba(130, 202, 157, 0.8)',
                        borderColor: 'rgba(130, 202, 157, 1)',
                        borderWidth: 1
                    }
                ]
            },
            options: chartConfig
        });

        // Graphique par phases
        const ctx2 = document.getElementById('phaseChart').getContext('2d');
        new Chart(ctx2, {
            type: 'bar',
            data: {
                labels: phaseData.map(p => p.phase),
                datasets: [
                    {
                        label: 'Estimé',
                        data: phaseData.map(p => p.estimated),
                        backgroundColor: 'rgba(255, 115, 0, 0.8)',
                        borderColor: 'rgba(255, 115, 0, 1)',
                        borderWidth: 1
                    },
                    {
                        label: 'Réalisé',
                        data: phaseData.map(p => p.actual),
                        backgroundColor: 'rgba(56, 121, 8, 0.8)',
                        borderColor: 'rgba(56, 121, 8, 1)',
                        borderWidth: 1
                    }
                ]
            },
            options: chartConfig
        });

        // Générer le tableau
        function generateTable() {
            const tbody = document.querySelector('#projectTable tbody');
            
            projectData.forEach(project => {
                const remaining = project.estimated - project.actual;
                const percentage = project.estimated > 0 ? ((project.actual / project.estimated) * 100) : 0;
                
                let status, statusClass;
                if (project.actual === 0) {
                    status = 'Non démarré';
                    statusClass = 'status-not-started';
                } else if (percentage >= 100) {
                    status = 'Terminé';
                    statusClass = 'status-completed';
                } else if (percentage >= 50) {
                    status = 'En cours';
                    statusClass = 'status-in-progress';
                } else {
                    status = 'Démarré';
                    statusClass = 'status-started';
                }

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${project.name}</td>
                    <td style="text-align: right;">${project.estimated.toFixed(2)}</td>
                    <td style="text-align: right;">${project.actual.toFixed(2)}</td>
                    <td style="text-align: right;">${remaining.toFixed(2)}</td>
                    <td style="text-align: right;">${percentage.toFixed(1)}%</td>
                    <td style="text-align: center;">
                        <span class="status-badge ${statusClass}">${status}</span>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Initialiser le tableau
        generateTable();
    </script>
</body>
</html>